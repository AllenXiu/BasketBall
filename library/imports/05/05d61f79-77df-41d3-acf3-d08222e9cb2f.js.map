{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "var TouchStatus = cc.Enum({\n    BEGEN:  -1, // 按下\n    ENDED:  -1, // 结束\n    CANCEL: -1  // 取消\n});\n\nvar BallStatus = cc.Enum({\n    FLY:  -1, // 飞\n    DOWN: -1, // 落\n    NONE: -1  // 静止\n});\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        emitSpeed: 0,   // 发射速度\n        gravity: 0,     // 重力速度\n        scale: 0,       // 缩放系数\n        showTime: 0,    // 生成篮球显示动画时间\n    },\n\n    init: function(game){\n        this.game = game;\n        this.registerInput();\n        this.enableInput(true);\n        this.showAnim();\n        this.valid = false;\n        this.status = TouchStatus.CANCEL;\n        this.currentHorSpeed = 0;\n        this.currentVerSpeed = 0;\n        this.target =  cc.p(0, 0);\n        this.node.setScale(1);\n        this.hitIn = false;\n    },\n\n    // 显示动画\n    showAnim: function(){\n        this.node.opacity = 0;\n        var fade = cc.fadeIn(this.showTime);\n        this.node.runAction(fade);    \n    },\n\n    // 注册事件监听\n    registerInput: function(){\n        this.listener = {\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\n            onTouchBegan: function(touch, event) { // 触摸事件开始\n                this.status = TouchStatus.BEGEN;\n                return true;\n            }.bind(this),\n\n            onTouchEnded: function (touch, event) { // 触摸事件结束\n                this.status = TouchStatus.ENDED;\n                this.enableInput(false);\n                \n                this.currentVerSpeed = this.emitSpeed;\n                this.target =  this.node.parent.convertToNodeSpaceAR(touch.getLocation()); // 记录最后触摸点,根据触摸点偏移计算速度\n                this.currentHorSpeed = this.target.x * 1.2;\n                \n                this.game.soundMng.playFlySound();\n\n                this.doAnim();\n            }.bind(this),\n\n            onTouchCancelled: function (touch, event) { // 触摸事件取消\n                this.status = TouchStatus.CANCEL;\n            }.bind(this)\n        },\n        cc.eventManager.addListener(this.listener, this.node);\n    },\n\n    // 控制事件是否生效\n    enableInput: function (enable) {\n        if (enable) {\n            cc.eventManager.resumeTarget(this.node);\n        } else {\n            cc.eventManager.pauseTarget(this.node);\n        }\n    },\n\n    // 篮球动画\n    doAnim: function(){\n        var scaleAnim = cc.scaleTo(1, this.scale);\n        var rotateValue = cc.randomMinus1To1();\n        var rotateAnim = cc.rotateBy(2, 360*rotateValue);\n        var anim = cc.spawn(scaleAnim,rotateAnim);\n        \n        this.node.runAction(anim);\n    },\n\n    update: function (dt) {\n        if(this.status != TouchStatus.ENDED){\n            return;\n        }\n\n        this._updatePosition(dt);\n        this._checkValid();\n    },\n    \n    _checkValid: function(){\n        if(this.ballStatus !== BallStatus.DOWN || this.valid){\n            return;\n        }\n        \n        var parent = this.node.parent;\n        if(parent != null){\n            var basket = this.game.basket;\n            var left = basket.left;\n            var right = basket.right;\n            var ballRadius = this.node.getBoundingBoxToWorld().width/2;\n            \n            /** 统一转换成世界坐标计算进球逻辑 */\n            // 篮球的边界和中心\n            var ballLeft = parent.convertToWorldSpaceAR(this.node.getPosition()).x - ballRadius;\n            var ballRight = parent.convertToWorldSpaceAR(this.node.getPosition()).x + ballRadius;\n            var ballX = parent.convertToWorldSpaceAR(this.node.getPosition()).x;\n            var ballY = parent.convertToWorldSpaceAR(this.node.getPosition()).y;\n            \n            // 有效进球范围\n            var validTop = parent.convertToWorldSpaceAR(basket.linePreNode.getPosition()).y - ballRadius;\n            var validLeft = basket.node.convertToWorldSpaceAR(left.getPosition()).x;\n            var validRight = basket.node.convertToWorldSpaceAR(right.getPosition()).x;\n            var validBot = basket.node.convertToWorldSpaceAR(left.getPosition()).y - ballRadius * 2;\n            \n            if(ballY < validTop && ballY > validBot && ballX > validLeft && ballX < validRight){\n                this.valid = true;\n                this.game.score.addScore();\n                if(this.hitIn){\n                    this.game.soundMng.playHitBoardInSound();\n                }else{\n                    this.game.soundMng.playBallInSound();\n                }\n            }\n        }\n    },\n\n    // 更新篮球位置\n    _updatePosition: function(dt){\n        this.node.x += dt * this.currentHorSpeed;\n        \n        this.currentVerSpeed -= dt * this.gravity;\n        this.node.y += dt * this.currentVerSpeed;\n        \n        this._changeBallStatus(this.currentVerSpeed);\n\n        if(this.ballStatus === BallStatus.NONE && this._isOutScreen()){\n            if(!this.valid){ // 没进球将分数重置\n                this.game.score.setScore(0);\n            }\n            \n            this.node.stopAllActions();\n            this.node.removeFromParent();\n            this.valid = false;\n            cc.pool.putInPool(this);\n            this.game.newBall();\n            return;\n        }\n    },\n    \n    _isOutScreen: function(){\n        return this.node.y < -800;\n    },\n\n    // 更改篮球状态\n    _changeBallStatus: function(speed){\n        if(speed === 0 || this._isOutScreen()){\n            this.ballStatus = BallStatus.NONE;\n        } else if(speed > 0) {\n            this.ballStatus = BallStatus.FLY;\n            this.game.basket.switchMaskLineShow(false);\n        } else {\n            this.ballStatus = BallStatus.DOWN;\n            this.game.basket.switchMaskLineShow(true);\n        }\n    },\n\n    onCollisionEnter: function (other, self) {\n        if(this.ballStatus === BallStatus.FLY){ // 篮球上升过程中不进行碰撞检测\n            return;\n        }\n\n        var box = other.node.getComponent('CollisionBox');\n        var left = box.getLeft();\n        var right = box.getRight();\n\n        // 篮球碰到篮筐内，改变篮球横向速度为反方向\n        if((other.node.name === 'right' && this.node.x < left) || (other.node.name === 'left' && this.node.x > right)){\n            this.currentHorSpeed = this.currentHorSpeed * -1 * 1.5;\n            this.hitIn = true;\n        }\n\n        // 篮球碰到篮筐外，增大横向速度\n        if((other.node.name === 'right' && this.node.x > right) || (other.node.name === 'left' && this.node.x < left)){\n            this.currentHorSpeed = this.currentHorSpeed * 1.5;\n        }\n        this.currentVerSpeed = this.currentVerSpeed * -1 * 1.2;\n        \n        this.game.soundMng.playHitBoardSound();\n        \n        // 碰撞系统会计算出碰撞组件在世界坐标系下的相关的值，并放到 world 这个属性里面\n        var world = self.world;\n\n        // 碰撞组件的 aabb 碰撞框\n        var aabb = world.aabb;\n\n        // 上一次计算的碰撞组件的 aabb 碰撞框\n        var preAabb = world.preAabb;\n\n        // 碰撞框的世界矩阵\n        var t = world.transform;\n\n        // 以下属性为圆形碰撞组件特有属性\n        var r = world.radius;\n        var p = world.position;\n    },\n \n});"
  ]
}